(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/thorui/tui-picture-cropper/tui-picture-cropper"],{"0e6d":function(t,e,i){"use strict";var n=i("8faf"),a=i.n(n);a.a},4228:function(t,e,i){"use strict";var n=function(t){t.options.wxsCallMethods||(t.options.wxsCallMethods=[]),t.options.wxsCallMethods.push("moveDuring"),t.options.wxsCallMethods.push("moveStop"),t.options.wxsCallMethods.push("change")};e["a"]=n},"8faf":function(t,e,i){},9410:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("a34a"));function a(t){return t&&t.__esModule?t:{default:t}}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e,i,n,a,o,s){try{var c=t[o](s),r=c.value}catch(h){return void i(h)}c.done?e(r):Promise.resolve(r).then(n,a)}function h(t){return function(){var e=this,i=arguments;return new Promise((function(n,a){var o=t.apply(e,i);function s(t){r(o,n,a,s,c,"next",t)}function c(t){r(o,n,a,s,c,"throw",t)}s(void 0)}))}}var u={name:"tuiPictureCropper",emits:["ready","cropper","initAngle","imageLoad"],props:{imageUrl:{type:String,default:""},height:{type:Number,default:280},width:{type:Number,default:280},minWidth:{type:Number,default:100},minHeight:{type:Number,default:100},maxWidth:{type:Number,default:360},maxHeight:{type:Number,default:360},borderColor:{type:String,default:"rgba(255,255,255,0.1)"},edgeColor:{type:String,default:"#FFFFFF"},edgeWidth:{type:String,default:"34rpx"},edgeBorderWidth:{type:String,default:"6rpx"},edgeOffsets:{type:String,default:"6rpx"},lockWidth:{type:Boolean,default:!1},lockHeight:{type:Boolean,default:!1},lockRatio:{type:Boolean,default:!1},scaleRatio:{type:Number,default:2},quality:{type:Number,default:.8},rotateAngle:{type:Number,default:0},minScale:{type:Number,default:.5},maxScale:{type:Number,default:2},disableRotate:{type:Boolean,default:!0},limitMove:{type:Boolean,default:!0},custom:{type:Boolean,default:!1},startCutting:{type:[Number,Boolean],default:0},isBase64:{type:Boolean,default:!1},loadding:{type:Boolean,default:!0},rotateImg:{type:String,default:"/static/components/cropper/img_rotate.png"}},data:function(){return{TIME_CUT_CENTER:null,CROPPER_WIDTH:200,CROPPER_HEIGHT:200,cutX:0,cutY:0,canvasWidth:0,canvasHeight:0,imgWidth:0,imgHeight:0,scale:1,angle:0,cutAnimation:!1,cutAnimationTime:null,imgTop:0,imgLeft:0,ctx:null,sysInfo:{},props:"",sizeChange:0,angleChange:0,resetChange:0,centerChange:0}},watch:{imageUrl:function(e,i){var n=this;this.imageReset(),this.showLoading(),t.getImageInfo({src:e,success:function(t){n.imgComputeSize(t.width,t.height),n.limitMove&&(n.angleChange++,n.props="3,".concat(n.angleChange))},fail:function(t){n.imgComputeSize(),n.limitMove&&(n.angleChange++,n.props="3,".concat(n.angleChange))}})},rotateAngle:function(t){this.cutAnimation=!0,this.angle=t,this.angleChanged(t)},cutAnimation:function(t){var e=this;clearTimeout(this.cutAnimationTime),t&&(this.cutAnimationTime=setTimeout((function(){e.cutAnimation=!1}),260))},limitMove:function(t){t&&this.angleChanged(this.angle)},startCutting:function(t){this.custom&&t&&this.getImage()}},mounted:function(){var e=this;this.sysInfo=t.getSystemInfoSync(),this.imgTop=this.sysInfo.windowHeight/2,this.imgLeft=this.sysInfo.windowWidth/2,this.CROPPER_WIDTH=this.width,this.CROPPER_HEIGHT=this.height,this.canvasHeight=this.height,this.canvasWidth=this.width,this.ctx=t.createCanvasContext("tui-image-cropper",this),setTimeout((function(){e.props="1,1"}),0),setTimeout((function(){e.$emit("ready",{})}),200)},methods:{getLocalImage:function(e){return h(n.default.mark((function i(){return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,new Promise((function(i,n){t.downloadFile({url:e,success:function(t){i(t.tempFilePath)},fail:function(t){n(!1)}})}));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}}),i)})))()},getImage:function(){var e=this;if(this.imageUrl){this.loadding&&this.showLoading();var i=function(){var i=h(n.default.mark((function i(){var a,o,c,r,h;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(a=e.imgWidth*e.scale*e.scaleRatio,o=e.imgHeight*e.scale*e.scaleRatio,c=e.imgLeft-e.cutX,r=e.imgTop-e.cutY,e.ctx.translate(c*e.scaleRatio,r*e.scaleRatio),e.ctx.rotate(e.angle*Math.PI/180),h=e.imageUrl,!~e.imageUrl.indexOf("https:")){i.next=11;break}return i.next=10,e.getLocalImage(e.imageUrl);case 10:h=i.sent;case 11:e.ctx.drawImage(h,-a/2,-o/2,a,o),e.ctx.draw(!1,(function(){var i={width:e.canvasWidth*e.scaleRatio,height:Math.round(e.canvasHeight*e.scaleRatio),destWidth:e.canvasWidth*e.scaleRatio,destHeight:Math.round(e.canvasHeight)*e.scaleRatio,fileType:"png",quality:e.quality},n={url:"",base64:"",width:e.canvasWidth*e.scaleRatio,height:e.canvasHeight*e.scaleRatio};e.isBase64?t.canvasGetImageData({canvasId:"tui-image-cropper",x:0,y:0,width:e.canvasWidth*e.scaleRatio,height:Math.round(e.canvasHeight*e.scaleRatio),success:function(i){var a=new Uint8Array(i.data),o=t.arrayBufferToBase64(a);n.base64=o,e.loadding&&t.hideLoading(),e.$emit("cropper",n)}},e):t.canvasToTempFilePath(s(s({},i),{},{canvasId:"tui-image-cropper",success:function(i){n.url=i.tempFilePath,e.loadding&&t.hideLoading(),e.$emit("cropper",n)},fail:function(t){console.log(t)}}),e)}));case 13:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();this.CROPPER_WIDTH!=this.canvasWidth||this.CROPPER_HEIGHT!=this.canvasHeight?(this.CROPPER_WIDTH=this.canvasWidth,this.CROPPER_HEIGHT=this.canvasHeight,this.$nextTick((function(){e.ctx.draw(),setTimeout((function(){i()}),100)}))):i()}else t.showToast({title:"请选择图片",icon:"none"})},change:function(t){this.cutX=t.cutX||0,this.cutY=t.cutY||0,this.canvasWidth=t.canvasWidth||this.width,this.canvasHeight=t.canvasHeight||this.height,this.imgWidth=t.imgWidth||this.imgWidth,this.imgHeight=t.imgHeight||this.imgHeight,this.scale=t.scale||1,this.angle=t.angle||0,this.imgTop=t.imgTop||0,this.imgLeft=t.imgLeft||0},imageReset:function(){this.scale=1,this.angle=0;var e=this.sysInfo.windowHeight?this.sysInfo:t.getSystemInfoSync();this.imgTop=e.windowHeight/2,this.imgLeft=e.windowWidth/2,this.resetChange++,this.props="4,".concat(this.resetChange),this.$emit("initAngle",{})},imageLoad:function(e){this.imageReset(),t.hideLoading(),this.$emit("imageLoad",{})},imgComputeSize:function(e,i){var n=e,a=i;if(n&&a)n/a>this.width/this.height?(a=this.height,n=e/i*a):(n=this.width,a=i/e*n);else{var o=this.sysInfo.windowHeight?this.sysInfo:t.getSystemInfoSync();n=o.windowWidth,a=0}this.imgWidth=n,this.imgHeight=a,this.sizeChange++,this.props="2,".concat(this.sizeChange)},moveStop:function(){var t=this;clearTimeout(this.TIME_CUT_CENTER),this.TIME_CUT_CENTER=setTimeout((function(){t.cutAnimation||(t.cutAnimation=!0),t.centerChange++,t.props="5,".concat(t.centerChange)}),666)},moveDuring:function(){clearTimeout(this.TIME_CUT_CENTER)},showLoading:function(){t.showLoading({title:"请稍候...",mask:!0})},stop:function(){},back:function(){t.navigateBack()},angleChanged:function(t){this.moveStop(),this.limitMove&&t%90&&(this.angle=90*Math.round(t/90)),this.angleChange++,this.props="3,".concat(this.angleChange)},setAngle:function(){this.cutAnimation=!0,this.angle=this.angle+90,this.angleChanged(this.angle)}}};e.default=u}).call(this,i("543d")["default"])},c07b:function(t,e,i){"use strict";i.r(e);var n=i("9410"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a},d7eb:function(t,e,i){"use strict";i.r(e);var n=i("f396"),a=i("c07b");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("0e6d");var s,c=i("f0c5"),r=i("4228"),h=Object(c["a"])(a["default"],n["b"],n["c"],!1,null,"607fcd9b",null,!1,n["a"],s);"function"===typeof r["a"]&&Object(r["a"])(h),e["default"]=h.exports},f396:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/thorui/tui-picture-cropper/tui-picture-cropper-create-component',
    {
        'components/thorui/tui-picture-cropper/tui-picture-cropper-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("d7eb"))
        })
    },
    [['components/thorui/tui-picture-cropper/tui-picture-cropper-create-component']]
]);
