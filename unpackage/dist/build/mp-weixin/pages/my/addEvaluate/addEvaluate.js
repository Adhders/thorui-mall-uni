(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/addEvaluate/addEvaluate"],{"15f6":function(t,e,n){"use strict";(function(t){n("c514");i(n("66fd"));var e=i(n("41d1"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},"41d1":function(t,e,n){"use strict";n.r(e);var i=n("6cc7"),o=n("695c");for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("9a5d");var u,s=n("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],u);e["default"]=r.exports},"695c":function(t,e,n){"use strict";n.r(e);var i=n("a368"),o=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"6cc7":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={tuiListCell:function(){return n.e("components/thorui/tui-list-cell/tui-list-cell").then(n.bind(null,"057e"))},tuiRate:function(){return n.e("components/thorui/tui-rate/tui-rate").then(n.bind(null,"0193"))},tuiUpload:function(){return n.e("components/thorui/tui-upload/tui-upload").then(n.bind(null,"b008"))},tuiButton:function(){return n.e("components/thorui/tui-button/tui-button").then(n.bind(null,"009d"))}},o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.postData.anonymous=!t.postData.anonymous})},a=[]},"9a5d":function(t,e,n){"use strict";var i=n("d143"),o=n.n(i);o.a},a368:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{mode:"",spu_id:"",index:0,width:"",height:"",orderNum:"",formData:{},bucket_image:"chuangbiying-review",action:"https://up-cn-east-2.qiniup.com",goodsImage:"",postData:{msg:"",specs:"",name:"",avatar:"",star:5,imgs:[],anonymous:!1,reviewState:[]}}},onLoad:function(e){var n=this,i=getApp().globalData.windowWidth/(t.upx2px(100)/100);this.width=(i-100)/3,this.height=this.width;var o="/upload/token/"+this.bucket_image;this.tui.request(o).then((function(t){n.uptoken=t.token,n.formData={token:n.uptoken}})).catch((function(t){console.log(t.response)})),this.mode=e.mode;var a=JSON.parse(decodeURIComponent(e.order));this.index=a.index?a.index:0;var u=a.goodsList[this.index];this.goodsImage=u.defaultImageUrl,this.orderNum=a.orderNum,this.postData.reviewState=JSON.parse(JSON.stringify(a.reviewState)),this.postData.reviewState[this.index].count+=1,"first"===this.mode&&(this.spu_id=u.spu_id,this.postData.specs=this.getProperty(u.propertyList),this.postData.name=this.userInfo.nickName,this.postData.avatar=this.userInfo.avatarUrl)},computed:{userInfo:function(){return this.$store.state.userInfo},orderList:function(){return this.$store.state.orderList}},methods:{getProperty:function(t){var e="";return t.forEach((function(t){e=e+t.value+"，"})),e.slice(0,-1)},change:function(t){this.postData.star=t.index},onSuccess:function(t){1===t.status&&(this.postData.imgs=t.keyList)},onSubmit:function(){var e=this,n=t.getStorageSync("pid"),i="",o="POST";"first"===this.mode?i="/addGoodsReview/"+this.spu_id+"/"+n+"/"+this.orderNum+"/"+this.index:(o="PUT",i="/updateGoodsReview/"+this.postData.reviewState[this.index].id+"/additional",console.log("put",i)),this.tui.request(i,o,this.postData).then((function(n){if("0"===n.code){var i=e.$store.state.orderList,o=i.findIndex((function(t){return t.orderNum===e.orderNum}));if("first"===e.mode){i[o].reviewState=n.reviewState;var a=e.postData.reviewState.findIndex((function(t){return 0===t.count}));-1===a&&(i[o].status="交易成功")}else i[o].reviewState=e.postData.reviewState;e.tui.toast("评论成功")}t.navigateBack({delta:1})}))}}};e.default=n}).call(this,n("543d")["default"])},d143:function(t,e,n){}},[["15f6","common/runtime","common/vendor"]]]);