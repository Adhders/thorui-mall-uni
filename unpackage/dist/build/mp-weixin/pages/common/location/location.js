(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/common/location/location"],{"0aeb":function(t,e,n){},"618d":function(t,e,n){"use strict";n.r(e);var i=n("8832"),o=n.n(i);for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);e["default"]=o.a},8832:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n("2f3b"));function o(t){return t&&t.__esModule?t:{default:t}}var s={data:function(){return{ani:!0,mapCtx:null,mapObj:null,longitude:121.499763,latitude:31.23958,key:"LWQBZ-SLH6F-VNOJD-N2ZI5-DA3YE-CKBR2",qqmapsdk:null,scrollH:0,address:[],timer:null,keywords:"车站",location:null,pageIndex:1,loading:!1,pullUpOn:!0,scrollTop:0,index:-1,isClick:!1,changeTimer:null,ruleForm:null}},filters:{getDistance:function(t,e){t=t||e;var n="";return n=t<1e3?t+"m":(t/1e3).toFixed(2)+"km",n}},onLoad:function(e){var n=this;this.keywords=e.keywords||"车站",setTimeout((function(){var e=t.getSystemInfoSync();n.scrollH=e.windowHeight-t.upx2px(600)-46,n.qqmapsdk=new i.default({key:n.key}),n.currentLocation()}),80),t.$on("location",(function(t){n.latitude=t.lat,n.longitude=t.lng,n.keywords=t.keywords,n.getPoiAround()})),this.ruleForm=JSON.parse(e.ruleForm),this.selectedIndex=e.selectedIndex},onReady:function(){},methods:{calculateDistance:function(t,e){this.qqmapsdk.calculateDistance({from:"",to:t,success:function(t){e&&e(t.result)},fail:function(t){e&&e(!1),console.log(t)}})},getPoiAround:function(){var t=this;this.keywords&&(this.pageIndex=1,this.pullUpOn=!0,this.address=[],this.index=-1,this.scrollTop=1,setTimeout((function(){t.scrollTop=0}),10),this.getLocation(this.keywords))},regionchange:function(e){var n=this,i="end"==e.type;i="end"==e.type&&("scale"==e.causedBy||"drag"==e.causedBy),i&&(clearTimeout(this.timer),this.ani=!1,this.timer=setTimeout((function(){n.ani=!0}),300),this.mapCtx||(this.mapCtx=t.createMapContext("maps")),this.mapCtx.getCenterLocation({type:"gcj02",success:function(t){n.latitude=t.latitude,n.longitude=t.longitude,n.getAddress(t.longitude,t.latitude)}}))},getAddress:function(t,e){var n=this;this.qqmapsdk.reverseGeocoder({location:{latitude:e,longitude:t},success:function(t){n.keywords=t.result.formatted_addresses.recommend,n.getPoiAround()},fail:function(t){n.keywords="车站",n.getPoiAround()}})},currentLocation:function(){var e=this;t.getLocation({type:"gcj02",altitude:!0,success:function(t){e.latitude=t.latitude,e.longitude=t.longitude,e.getAddress(t.longitude,t.latitude)},fail:function(t){e.getAddress(e.longitude,e.latitude)}})},getLocation:function(){var t=this;if(this.pullUpOn&&!this.loading){this.loading=!0;var e=this.keywords,n=e.indexOf("(");-1!==n&&(e=e.substring(0,n)),this.qqmapsdk.getSuggestion({keyword:e,page_index:this.pageIndex,location:{latitude:this.latitude,longitude:this.longitude},success:function(e){var n=e.data||[];t.calculateDistance(n,(function(e){if(e)for(var i=e.elements||[],o=0,s=n.length;o<s;o++)n[o].distance=i[o].distance;t.address=t.address.concat(n),t.pageIndex++,t.loading=!1,n.length<10&&(t.pullUpOn=!1)}))},fail:function(e){t.loading=!1,console.log(e)}})}},search:function(){this.tui.href("../search-suggest/search-suggest")},back:function(){t.navigateBack()},radioChange:function(t){var e=this;clearTimeout(this.changeTimer),this.changeTimer=null,this.index=Number(t.detail.value);var n=this.address[this.index];this.isClick=!0,this.latitude=n.location.lat,this.longitude=n.location.lng,this.changeTimer=setTimeout((function(){e.isClick=!1}),1200)},btnFix:function(){var e=this.address[this.index];this.ruleForm.location=e.province+" "+e.city+" "+e.district,this.ruleForm.detailInfo=e.address;var n="/pages/my/editAddress/editAddress?address="+JSON.stringify(this.ruleForm),i=void 0!==this.selectedIndex?n+"&selectedIndex="+this.selectedIndex:n;t.redirectTo({url:i})}}};e.default=s}).call(this,n("543d")["default"])},bbc6:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return i}));var i={tuiListCell:function(){return n.e("components/thorui/tui-list-cell/tui-list-cell").then(n.bind(null,"057e"))},tuiLoadmore:function(){return n.e("components/thorui/tui-loadmore/tui-loadmore").then(n.bind(null,"5f80"))},tuiButton:function(){return n.e("components/thorui/tui-button/tui-button").then(n.bind(null,"009d"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.address,(function(e,n){var i=t.__get_orig(e),o=t._f("getDistance")(e.distance,e._distance),s=n.toString();return{$orig:i,f0:o,g0:s}})));t.$mp.data=Object.assign({},{$root:{l0:n}})},s=[]},c617:function(t,e,n){"use strict";(function(t){n("c514");i(n("66fd"));var e=i(n("fff4"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n("543d")["createPage"])},d413:function(t,e,n){"use strict";var i=n("0aeb"),o=n.n(i);o.a},fff4:function(t,e,n){"use strict";n.r(e);var i=n("bbc6"),o=n("618d");for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);n("d413");var u,a=n("f0c5"),r=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],u);e["default"]=r.exports}},[["c617","common/runtime","common/vendor"]]]);