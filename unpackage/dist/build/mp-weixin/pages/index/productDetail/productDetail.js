(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/productDetail/productDetail"],{"1d91":function(t,e,i){"use strict";var n=i("80b8"),o=i.n(n);o.a},"7c46":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return n}));var n={tuiIcon:function(){return Promise.all([i.e("common/vendor"),i.e("components/thorui/tui-icon/tui-icon")]).then(i.bind(null,"acf0"))},tuiBadge:function(){return i.e("components/thorui/tui-badge/tui-badge").then(i.bind(null,"ca13"))},tuiSlider:function(){return i.e("components/thorui/tui-slider/tui-slider").then(i.bind(null,"2315"))},tuiTag:function(){return i.e("components/thorui/tui-tag/tui-tag").then(i.bind(null,"9d73"))},tuiRate:function(){return i.e("components/thorui/tui-rate/tui-rate").then(i.bind(null,"0193"))},tuiNomore:function(){return i.e("components/thorui/tui-nomore/tui-nomore").then(i.bind(null,"3a24"))},tuiButton:function(){return i.e("components/thorui/tui-button/tui-button").then(i.bind(null,"009d"))},tuiTopDropdown:function(){return i.e("components/thorui/tui-top-dropdown/tui-top-dropdown").then(i.bind(null,"2f5f"))},tuiBottomPopup:function(){return i.e("components/thorui/tui-bottom-popup/tui-bottom-popup").then(i.bind(null,"dd5b"))},tuiModal:function(){return i.e("components/thorui/tui-modal/tui-modal").then(i.bind(null,"cd19"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t._f("attrFormat")(t.selectedGoodsAttrList)),n=t._f("propsFormat")(t.goodsDetail.selectedGoodsPropList),o=t.parseDetail(t.goodsDetail.detail);t.$mp.data=Object.assign({},{$root:{f0:i,f1:n,m0:o}})},a=[]},"80b8":function(t,e,i){},a9d5:function(t,e,i){"use strict";i.r(e);var n=i("7c46"),o=i("b4a2");for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);i("1d91");var r,s=i("f0c5"),u=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"afa79a9e",null,!1,n["a"],r);e["default"]=u.exports},b4a2:function(t,e,i){"use strict";i.r(e);var n=i("db73"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},b7d2:function(t,e,i){"use strict";(function(t){i("c514");n(i("66fd"));var e=n(i("a9d5"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i("543d")["createPage"])},db73:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("a34a")),o=(a(i("40bc")),a(i("bad4")));function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i,n,o,a,r){try{var s=t[a](r),u=s.value}catch(c){return void i(c)}s.done?e(u):Promise.resolve(u).then(n,o)}function s(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function s(t){r(a,n,o,s,u,"next",t)}function u(t){r(a,n,o,s,u,"throw",t)}s(void 0)}))}}var u=function(){i.e("components/views/addCart/addCart").then(function(){return resolve(i("46b2"))}.bind(null,i)).catch(i.oe)},c=function(){Promise.all([i.e("common/vendor"),i.e("components/uni/uParse/src/wxParse")]).then(function(){return resolve(i("8b72"))}.bind(null,i)).catch(i.oe)},d={components:{uParse:c,popupBox:u},data:function(){return{initial:!0,ismute:!0,voiceControl:"https://system.chuangbiying.com/assets/svg/mute.svg",detail:"",reviews:0,shareText:"",skuArray:[],propsList:[],invalidSkuList:[],invalidSkuIndexList:[],selectedIndex:[],height:getApp().globalData.navBarHeight,top:getApp().globalData.menuTop,scrollH:getApp().globalData.windowWidth,opcity:0,mode:"service",iconOpcity:.5,bannerIndex:0,topMenu:[{icon:"message",text:"消息",size:26,badge:0},{icon:"home",text:"首页",size:23,badge:0},{icon:"people",text:"我的",size:26,badge:0},{icon:"cart",text:"购物车",size:23,badge:0},{icon:"kefu",text:"客服小蜜",size:26,badge:0},{icon:"feedback",text:"我要反馈",size:23,badge:0},{icon:"share",text:"分享",size:26,badge:0}],total:0,menuShow:!1,popupShow:!1,buyNum:1,spu_id:1,collected:!1,sharePopup:!1,posterImg:"",winWidth:t.upx2px(1120),winHeight:t.upx2px(1780),modalShow:!1,skuList:[],videoplayObj:{},playing:!0,startVideo:!0,currentTime:0,duration:15,selectedGoodsAttrList:[],goodsDetail:{selectedGoodsPropList:[]}}},onLoad:function(e){var i=this;this.videoplayObj=wx.createVideoContext("myVideo"),t.setStorageSync("currentTime",0),setTimeout((function(){i.startVideo=!1}),600),this.spu_id=parseInt(e.spu_id);var n=parseInt(e.sku_id);this.$refs.popup.initial(this.spu_id,n),Boolean(e.buy)&&(this.$refs.popup.popupShow=!0);var o="/getGoodsReview/"+this.spu_id;this.tui.request(o).then((function(t){"0"===t.code&&(i.reviews=t.reviewList.length,i.$store.commit("setReviewList",t.reviewList))})),this.shareText=this.$store.state.shareText;var a=0,r=this.cart.filter((function(t){return!t.invalid}));r.map((function(t){a+=t.buyNum})),this.topMenu[3].badge=a,this.total=a},onShow:function(){var e=t.getStorageSync("playState");if(""!==e){t.removeStorageSync("playState");var i=t.getStorageSync("currentTime");this.videoplayObj.seek(i),e?(this.videoplayObj.play(),this.startVideo=!1,this.playing=!0):(this.videoplayObj.pause(),this.startVideo=!0,this.palying=!1)}},filters:{getPrice:function(t){return t=t||0,t.toFixed(2)},attrFormat:function(t){var e="";return t.forEach((function(t){e+=t.value+"，"})),e.slice(0,-1)},propsFormat:function(t){var e="";return t.forEach((function(t){e+=t.name+"　"})),e}},computed:{reviewList:function(){return this.$store.state.reviewList},goodsList:function(){return this.$store.state.goodsList},cart:function(){return this.$store.state.cart}},methods:{onSelectGoods:function(t,e){this.goodsDetail=t,this.selectedGoodsAttrList=e},submit:function(){this.$refs.popup.submit()},endedFun:function(){this.startVideo=!0,this.playing=!1,t.setStorageSync("currentTime",0)},onChange:function(){this.ismute=!this.ismute,this.voiceControl=this.ismute?"https://system.chuangbiying.com/assets/svg/mute.svg":"https://system.chuangbiying.com/assets/svg/volume.svg"},videoPlay:function(){this.startVideo=!1,this.playing=!0;var e=t.getStorageSync("currentTime");this.videoplayObj.play(),this.videoplayObj.seek(e)},timeupdate:function(t){this.duration=parseInt(t.detail.duration),this.currentTime=parseInt(t.detail.currentTime)},bannerChange:function(e){if(this.bannerIndex=e.detail.current,this.goodsDetail.videoUrl)if(0!==this.bannerIndex)this.playing&&(this.playing=!1,t.setStorageSync("currentTime",this.currentTime)),this.videoplayObj.pause();else if(!this.startVideo){var i=t.getStorageSync("currentTime");this.videoplayObj.play(),this.videoplayObj.seek(i),this.playing=!0}},previewImage:function(e){var i=e.currentTarget.dataset.index;t.previewImage({current:this.banner[i],urls:this.banner})},back:function(){t.navigateBack()},openService:function(){var t=this.$store.state.serviceId,e=this.$store.state.corpId;wx.openCustomerServiceChat({extInfo:{url:t},corpId:e,success:function(t){console.log("res",t)}})},parseDetail:function(t){var e=this;if(this.initial&&t){this.initial=!1;var i=t.replace(/<\/br>|<br\/>/,"").split(/(<p><iframe.*?iframe><\/p>)/gi);i.forEach((function(t){var i=t.match(/url=(.*)&coverurl/);if(i){var n=i[1];e.detail=e.detail+'<video style="width:100%" src='.concat(n," controls></video>")}else e.detail=e.detail+t}))}return this.detail},openMenu:function(){this.menuShow=!0},closeMenu:function(){this.menuShow=!1},showPopup:function(t){"cart"===t?this.$refs.popup.popupShow=!0:(this.mode=t,this.popupShow=!0)},hidePopup:function(){this.popupShow=!1},change:function(t){this.buyNum=t.value},collecting:function(){this.collected=!this.collected},evaluate:function(){this.reviews>0&&this.tui.href("/pages/index/goodsEvaluate/goodsEvaluate")},common:function(){this.tui.toast("功能开发中~")},btnTopMenu:function(t){if(this.closeMenu(),4==t)this.openService();else if(6==t)this.showSharePopup();else{var e={0:"/pages/my/message/message",1:"/pages/tabbar/index/index",2:"/pages/tabbar/my/my",3:"/pages/tabbar/cart/cart",5:"/pages/my/feedback/feedback?page=mall"}[t];this.tui.href(e)}},coupon:function(){this.tui.href("/pages/index/coupon/coupon",!0)},onShare:function(){this.hideSharePopup()},shop:function(){t.navigateTo({url:"/pages/tabbar/index/index"})},play:function(e){t.navigateTo({url:"/pages/index/video/video?videoUrl="+e+"&currentTime="+this.currentTime,animationType:"zoom-out"})},showSharePopup:function(){this.sharePopup=!0},hideSharePopup:function(){this.sharePopup=!1},createPoster:function(){var e=this;return s(n.default.mark((function i(){var a,r,s;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.hideSharePopup(),!e.posterImg){i.next=4;break}return e.modalShow=!0,i.abrupt("return");case 4:return t.showLoading({mask:!0,title:"图片生成中..."}),i.prev=5,i.next=8,o.default.getImage(e.goodsDetail.defaultImageUrl);case 8:return a=i.sent,i.next=11,o.default.getImage(e.$store.state.qrcode);case 11:return r=i.sent,i.next=14,o.default.removeSavedFile();case 14:a&&r?(s={mainPic:a,qrcode:r},o.default.drawGoodsPoster("posterId",e.winWidth,e.winHeight,s,e.goodsDetail.title,e.goodsDetail.price,e.goodsDetail.originalPrice,e.shareText,(function(i){t.hideLoading(),i?(e.posterImg=i,setTimeout((function(){e.modalShow=!0}),60)):e.tui.toast("生成海报失败,请稍后再试")}))):(t.hideLoading(),e.tui.toast("生成海报图片下载失败,请稍后再试")),i.next=20;break;case 17:i.prev=17,i.t0=i["catch"](5),console.log("err",i.t0);case 20:case"end":return i.stop()}}),i,null,[[5,17]])})))()},hideModal:function(){this.modalShow=!1},savePic:function(){this.posterImg&&(o.default.saveImage(this.posterImg),this.hideModal())}},onPageScroll:function(t){var e=t.scrollTop<=0?0:t.scrollTop,i=e/this.scrollH;this.opcity>=1&&i>=1||(this.opcity=i,this.iconOpcity=.5*(1-i<0?0:1-i))}};e.default=d}).call(this,i("543d")["default"])}},[["b7d2","common/runtime","common/vendor"]]]);